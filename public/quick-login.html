<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تسجيل دخول سريع</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 40px; text-align: center; }
        .login-section { background: #f8f9fa; padding: 30px; margin: 20px auto; border-radius: 8px; max-width: 400px; }
        button { background: #007bff; color: white; padding: 12px 24px; border: none; border-radius: 4px; cursor: pointer; margin: 10px; }
        button:hover { background: #0056b3; }
        .info { background: #e7f3ff; padding: 15px; border-radius: 4px; margin: 15px 0; }
    </style>
</head>
<body>
    <h1>تسجيل دخول سريع للاختبار</h1>
    
    <div class="login-section">
        <div class="info">
            <h3>معلومات تسجيل الدخول المتاحة:</h3>
            <p><strong>المدير العام:</strong> admin@abraj.com / admin123</p>
            <p><strong>مدير المشاريع:</strong> manager@abraj.com / manager123</p>
            <p><strong>الموظف:</strong> employee@abraj.com / employee123</p>
        </div>
        
        <button onclick="quickLogin('admin@abraj.com', 'admin123')">دخول كمدير عام</button>
        <button onclick="quickLogin('manager@abraj.com', 'manager123')">دخول كمدير مشاريع</button>
        <button onclick="quickLogin('employee@abraj.com', 'employee123')">دخول كموظف</button>
    </div>
    
    <div id="status"></div>

    <script>
        async function quickLogin(email, password) {
            const statusDiv = document.getElementById('status');
            statusDiv.innerHTML = '<p style="color: #007bff;">جاري تسجيل الدخول...</p>';
            
            try {
                // الحصول على CSRF token
                const tokenResponse = await fetch('/login');
                const tokenHtml = await tokenResponse.text();
                const tokenMatch = tokenHtml.match(/name="_token" value="([^"]+)"/);
                
                if (!tokenMatch) {
                    throw new Error('لا يمكن الحصول على CSRF token');
                }
                
                const token = tokenMatch[1];
                
                // تسجيل الدخول
                const formData = new FormData();
                formData.append('_token', token);
                formData.append('email', email);
                formData.append('password', password);
                
                const loginResponse = await fetch('/login', {
                    method: 'POST',
                    body: formData,
                    credentials: 'same-origin'
                });
                
                if (loginResponse.redirected || loginResponse.url.includes('/dashboard') || loginResponse.url.includes('/fuel-management')) {
                    statusDiv.innerHTML = '<p style="color: #28a745;">تم تسجيل الدخول بنجاح!</p>';
                    // الانتقال لصفحة إدارة المحروقات
                    setTimeout(() => {
                        window.location.href = '/fuel-management';
                    }, 1000);
                } else {
                    throw new Error('فشل تسجيل الدخول');
                }
                
            } catch (error) {
                statusDiv.innerHTML = `<p style="color: #dc3545;">خطأ: ${error.message}</p>`;
                console.error('Login error:', error);
            }
        }
    </script>
</body>
</html>
